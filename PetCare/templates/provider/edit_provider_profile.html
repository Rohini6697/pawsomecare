{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Edit Profile | Pawsome Care</title>
    <link rel="stylesheet" href="{% static 'css/provider/edit_provider_profile.css' %}">
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;600;700&display=swap" rel="stylesheet">
</head>
<body>

<div class="page-wrapper">

    <!-- PROFILE HEADER -->
    <div class="profile-header">
        <div class="profile-img-wrapper">
            {% if provider.profile_photo %}
                <img src="{{ provider.profile_photo.url }}" alt="Profile">
            {% else %}
                <img src="{% static 'images/default_profile.png' %}" alt="Profile">
            {% endif %}
            <label class="upload-btn">
                Change Photo
                <input type="file" name="profile_photo" hidden>
            </label>
        </div>

        <div class="profile-basic">
            <h2>{{ provider.full_name|default:"Your Name" }}</h2>
            <p>{{ provider.city|default:"City" }}</p>
            <span class="badge">
                {{ provider.provider_type|title }}
            </span>
        </div>
    </div>

    <!-- FORM CARD -->
    <form method="post" enctype="multipart/form-data" class="form-card">
        {% csrf_token %}

        <!-- BASIC INFO -->
        <div class="section">
            <h3>Basic Information</h3>

            <div class="form-grid">
                <div>
                    <label>Full Name</label>
                    <input type="text" name="full_name" value="{{ provider.full_name }}">
                </div>

                <div>
                    <label>Phone Number</label>
                    <input type="text" name="phone_number" value="{{ provider.phone_number }}">
                </div>

                <div>
                    <label>Provider Type</label>
                    <select name="provider_type">
                        <option value="individual" {% if provider.provider_type == 'individual' %}selected{% endif %}>Individual</option>
                        <option value="organization" {% if provider.provider_type == 'organization' %}selected{% endif %}>Organization</option>
                    </select>
                </div>
            </div>

            <label>About You</label>
            <textarea name="bio">{{ provider.bio }}</textarea>
        </div>

        <!-- LOCATION -->
        <div class="section">
            <h3>Location</h3>

            <div class="form-grid">
                <div>
                    <label>City</label>
                    <input type="text" name="city" value="{{ provider.city }}">
                </div>

                <div>
                    <label>Pincode</label>
                    <input type="text" name="pincode" value="{{ provider.pincode }}">
                </div>

                <div class="full">
                    <label>Address</label>
                    <input type="text" name="address" value="{{ provider.address }}">
                </div>

                <div>
                    <label>Travel Distance (km)</label>
                    <input type="number" name="travel_distance" value="{{ provider.travel_distance }}">
                </div>
            </div>
        </div>

        <div class="section">
    <h3>Services & Price</h3>

    <div id="services-container">

        {% if provider.services %}
            {% for service, price in provider.services.items %}
                <div class="service-row">
                    <input type="text" 
                           name="service_name_{{ forloop.counter }}" 
                           value="{{ service }}" 
                           placeholder="Service Name">

                    <input type="number" 
                           name="price_{{ forloop.counter }}" 
                           value="{{ price }}" 
                           placeholder="Price">
                </div>
            {% endfor %}
        {% endif %}

    </div>

    <button type="button" onclick="addService()">+ Add Service</button>
</div>


        <!-- SAVE -->
        <div class="action-bar">
            <button type="submit" class="save-btn">Save Changes</button>
            <a href="{% url 'provider_home' %}" class="cancel-btn">Cancel</a>
        </div>

    </form>

</div>
<script>
    let serviceCount = {{ service_count }};

    function addService() {
        serviceCount++;

        const container = document.getElementById("services-container");

        const div = document.createElement("div");
        div.classList.add("service-row");

        div.innerHTML = `
            <input type="text" name="service_name_${serviceCount}" placeholder="Service Name">
            <input type="number" name="price_${serviceCount}" placeholder="Price">
        `;

        container.appendChild(div);
    }
</script>

</body>
</html>
